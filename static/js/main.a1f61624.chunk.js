(this.webpackJsonpphage=this.webpackJsonpphage||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=n(37),i=n.n(s),o=n(5),c=n(4),u=n.n(c),l=n(10),h=n(3),p=new Map([["eyes",[-1,1]],["expression",[-1,1]],["jawHeight",[0,1]],["jawTwist",[-1,1]],["lipCurl",[-1,1]],["lipSync",[-1,1]],["symmetry",[0,1]],["tongue",[0,1]],["width",[-1,1]]]),g=new Map([["eyes",{targets:[0,1,7,8],thresholds:[-1,0,0,.1]}],["eyeLookSide",{targets:[2,3],thresholds:[-1,0]}],["expression",{targets:[20,9],thresholds:[-1,0]}],["jawHeight",{targets:[10,11],thresholds:[0,0]}],["jawTwist",{targets:[12,13],thresholds:[-1,0]}],["lipCurl",{targets:[15,16],thresholds:[-1,0]}],["lipSync",{targets:[17,18,19],thresholds:[-1,0,.5]}],["symmetry",{targets:[14],thresholds:[0]}],["sex",{targets:[22],thresholds:[0]}],["tongue",{targets:[4],thresholds:[0]}],["tongueDown",{targets:[1],thresholds:[0]}],["tongueTwist",{targets:[2,3],thresholds:[-1,0]}],["teethOpenBot",{targets:[3,0],thresholds:[0,0]}],["teethOpenTop",{targets:[3,0],thresholds:[0,0]}],["teethSideBot",{targets:[1,2],thresholds:[-1,0]}],["teethSideTop",{targets:[1,2],thresholds:[-1,0]}],["width",{targets:[23,24],thresholds:[-1,0]}]]),f=[[.96,6.169,1.305],[-.96,6.169,1.305]],d=n(21),m=n.n(d),v=n(0),y=function e(t){var n=this;Object(v.a)(this,e),this.geometry=void 0,this.json=void 0,this.isBitSet=function(e,t){return e&1<<t},this.parseModel=function(e){var t=n.json,r=t.faces,a=t.vertices,s=t.normals,i=t.colors,o=0;if(void 0!==n.json.uvs){for(var c=0;c<n.json.uvs.length;c++)n.json.uvs[c].length&&o++;for(var u=0;u<o;u++)n.geometry.faceVertexUvs[u]=[]}for(var l=0,p=a.length;l<p;){var g=new h.m;g.x=a[l++]*e,g.y=a[l++]*e,g.z=a[l++]*e,n.geometry.vertices.push(g)}for(l=0,p=r.length;l<p;){var f=r[l++],d=n.isBitSet(f,0),m=n.isBitSet(f,1),v=n.isBitSet(f,3),y=n.isBitSet(f,4),b=n.isBitSet(f,5),j=n.isBitSet(f,6),w=n.isBitSet(f,7);if(d){var S=r[l],x=r[l+1],k=r[l+3],O=new h.d(S,x,k),E=r[l+1],H=r[l+2],T=r[l+3],I=new h.d(E,H,T);if(l+=4,m){var N=r[l++];O.materialIndex=N,I.materialIndex=N}var W=n.geometry.faces.length;if(v)for(var B=0;B<o;B++){var L=n.json.uvs[B];n.geometry.faceVertexUvs[B][W]=[],n.geometry.faceVertexUvs[B][W+1]=[];for(var C=0;C<4;C++){var V=r[l++],P=L[2*V],M=L[2*V+1],R=new h.l(P,M);2!==C&&n.geometry.faceVertexUvs[B][W].push(R),0!==C&&n.geometry.faceVertexUvs[B][W+1].push(R)}}if(y){var U=3*r[l++];O.normal.set(s[U++],s[U++],s[U]),I.normal.copy(O.normal)}if(b)for(var z=0;z<4;z++){var F=3*r[l++],A=new h.m(s[F++],s[F++],s[F]);2!==z&&O.vertexNormals.push(A),0!==z&&I.vertexNormals.push(A)}if(j){var D=i[r[l++]];O.color.setHex(D),I.color.setHex(D)}if(w)for(var J=0;J<4;J++){var K=i[r[l++]];2!==J&&O.vertexColors.push(new h.b(K)),0!==J&&I.vertexColors.push(new h.b(K))}n.geometry.faces.push(O),n.geometry.faces.push(I)}else{var G=r[l++],q=r[l++],Z=r[l++],$=new h.d(G,q,Z);if(m){var X=r[l++];$.materialIndex=X}var Y=n.geometry.faces.length;if(v)for(var _=0;_<o;_++){var Q=n.json.uvs[_];n.geometry.faceVertexUvs[_][Y]=[];for(var ee=0;ee<3;ee++){var te=r[l++],ne=Q[2*te],re=Q[2*te+1],ae=new h.l(ne,re);n.geometry.faceVertexUvs[_][Y].push(ae)}}if(y){var se=3*r[l++];$.normal.set(s[se++],s[se++],s[se])}if(b)for(var ie=0;ie<3;ie++){var oe=3*r[l++],ce=new h.m(s[oe++],s[oe++],s[oe]);$.vertexNormals.push(ce)}if(j){var ue=r[l++];$.color.setHex(i[ue])}if(w)for(var le=0;le<3;le++){var he=r[l++];$.vertexColors.push(new h.b(i[he]))}n.geometry.faces.push($)}}},this.parseSkin=function(){var e=void 0!==n.json.influencesPerVertex?n.json.influencesPerVertex:2;if(n.json.skinWeights)for(var t=0,r=n.json.skinWeights.length;t<r;t+=e){var a=n.json.skinWeights[t],s=e>1?n.json.skinWeights[t+1]:0,i=e>2?n.json.skinWeights[t+2]:0,o=e>3?n.json.skinWeights[t+3]:0;n.geometry.skinWeights.push(new h.n(a,s,i,o))}if(n.json.skinIndices)for(var c=0,u=n.json.skinIndices.length;c<u;c+=e){var l=n.json.skinIndices[c],p=e>1?n.json.skinIndices[c+1]:0,g=e>2?n.json.skinIndices[c+2]:0,f=e>3?n.json.skinIndices[c+3]:0;n.geometry.skinIndices.push(new h.n(l,p,g,f))}n.geometry.bones=n.json.bones,n.geometry.bones&&n.geometry.bones.length>0&&(n.geometry.skinWeights.length!==n.geometry.skinIndices.length||n.geometry.skinIndices.length!==n.geometry.vertices.length)&&console.warn("GeometryParser: When skinning, number of vertices (".concat(n.geometry.vertices.length,"), skinIndices (").concat(n.geometry.skinIndices.length,"), and skinWeights (").concat(n.geometry.skinWeights.length,") should match.")),n.geometry.animation=n.json.animation,n.geometry.animations=n.json.animations},this.parseMorphing=function(e){if(void 0!==n.json.morphTargets)for(var t=0,r=n.json.morphTargets.length;t<r;t++){n.geometry.morphTargets[t]={name:n.json.morphTargets[t].name,vertices:[]};for(var a=n.geometry.morphTargets[t].vertices,s=n.json.morphTargets[t].vertices,i=0,o=s.length;i<o;i+=3){var c=new h.m;c.x=s[i]*e,c.y=s[i+1]*e,c.z=s[i+2]*e,a.push(c)}}},this.parse=function(){var e=void 0!==n.json.scale?1/n.json.scale:1;n.parseModel(e),n.parseSkin(),n.parseMorphing(e),n.geometry.computeFaceNormals(),n.geometry.computeBoundingSphere();var t=(new h.a).fromGeometry(n.geometry);return t.morphTargets=[],{geometry:t}},this.geometry=new h.e,this.json=t},b=function(){var e=new h.j,t=window.innerWidth,n=window.innerHeight,r=t/n,a=new h.i(55,r,.1,1e3);a.position.y=5,a.position.z=10;var s=new h.o({antialias:!0,preserveDrawingBuffer:!0});s.setSize(t,n);var i=new h.c(16777215,1);return i.position.set(0,0,1),e.add(i),[s,e,a]},j=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["ginger-left-eye","ginger-right-eye","ginger-head","ginger-head-band","ginger-head-phones","ginger-teeth-top","ginger-teeth-bot","ginger-tongue"],e.next=3,Promise.all(t.map((function(e){return m.a.get("/model/".concat(e,".json")).then((function(e){return e.data}))})));case 3:return n=e.sent,r=n.map((function(e,n){var r=new y(e).parse().geometry,a=new h.h({morphTargets:!0}),s=new h.g(r,a);return s.name=t[n],s})),e.next=7,(new h.k).loadAsync("/model/ginger-color.jpg");case 7:return a=e.sent,r.forEach((function(e){"ginger-head-phones"!==e.name&&e.traverse((function(e){e instanceof h.g&&(e.material.map=a)}))})),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function e(t){var n=t.renderer,r=t.scene,a=t.camera,s=t.mousePositionRef,i=t.eyes,o=s.current,c=o.x,u=o.y,l=new h.m(c/window.innerWidth*2-1,-u/window.innerHeight*2+1,.5);l.unproject(a);var p=l.sub(a.position).normalize();p.x*=-1,p.y*=-1;var g=a.position.z/p.z,f=a.position.clone().add(p.multiplyScalar(g));return i.forEach((function(e){e.lookAt(f),e.rotation.x/=3,e.rotation.y/=3})),n.render(r,a),requestAnimationFrame((function(){e(t)}))},S=function(e,t){var n=p.get(e),r=Object(o.a)(n,2),a=r[0];return(r[1]-a)*t+a},x=function(e,t,n){for(var r=-1,a=0;a<t.thresholds.length;a+=1){n>=t.thresholds[a]&&(r=a)}for(var s=0;s<t.targets.length;s+=1){var i=t.targets[s];t.targets[s]!==t.targets[r]?e.morphTargetInfluences[i]=0:e.morphTargetInfluences[i]=Math.abs(n)}},k=(n(62),function(e){var t=e.morphControls,n=Object(r.createRef)(),s=Object(r.useState)(!0),i=Object(o.a)(s,2),c=i[0],p=i[1],d=Object(r.useState)(!1),m=Object(o.a)(d,2),v=m[0],y=m[1],k=Object(r.useState)(),O=Object(o.a)(k,2),E=O[0],H=O[1],T=Object(r.useState)(),I=Object(o.a)(T,2),N=I[0],W=I[1],B=Object(r.useState)(),L=Object(o.a)(B,2),C=L[0],V=L[1],P=Object(r.useRef)({x:0,y:0}),M=Object(r.useRef)(),R=function(e){var t=e.clientX,n=e.clientY;P.current={x:t,y:n}};(Object(r.useEffect)((function(){return function(){var e=Object(l.a)(u.a.mark((function e(){var t,r,a,s,i,c,l,g,d,m,v,S,x,k,O,E,T;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b(),a=Object(o.a)(r,3),s=a[0],i=a[1],c=a[2],e.prev=1,e.next=4,j();case 4:l=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),y(!0),e.abrupt("return");case 11:g=l,d=Object(o.a)(g,8),m=d[0],v=d[1],S=d[2],x=d[3],k=d[4],O=d[5],E=d[6],T=d[7],S.add(m),S.add(v),[m,v].forEach((function(e,t){var n=Object(o.a)(f[t],3),r=n[0],a=n[1],s=n[2];e.position.set(r,a,s),e.geometry.applyMatrix4((new h.f).makeTranslation(-r,-a,-s))})),i.add(S),i.add(x),i.add(k),i.add(O),i.add(E),i.add(T),null===(t=n.current)||void 0===t||t.appendChild(s.domElement),M.current=w({renderer:s,scene:i,camera:c,eyes:[m,v],mousePositionRef:P}),document.addEventListener("mousemove",R),p(!1),H(S),W(T),V(E);case 29:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}()(),function(){cancelAnimationFrame(M.current),document.removeEventListener("mousemove",R)}}),[]),E&&N&&C)&&function(e,t,n,r,a){x(e,g.get("jawHeight"),S("jawHeight",r)),x(t,g.get("tongueDown"),S("tongue",r)),x(n,g.get("teethOpenBot"),S("jawHeight",r)),x(e,g.get("lipSync"),S("lipSync",a))}(E,N,C,t.jawHeight,t.lipSync);return a.a.createElement(a.a.Fragment,null,a.a.createElement(a.a.Fragment,null,c&&a.a.createElement("div",{className:"ginger-overlay ginger-pulse"},a.a.createElement("h2",{className:"heading"},"Loading..."))),a.a.createElement(a.a.Fragment,null,v&&a.a.createElement("div",{className:"ginger-overlay"},a.a.createElement("h2",{className:"heading"},"Oops..."),a.a.createElement("p",{className:"description"},"Something went wrong."),a.a.createElement("p",{className:"description"},"Please try again later."))),a.a.createElement("div",{id:"renderer",ref:n}))}),O=n(25),E=n.n(O),H=n(12),T=(n(63),n(27)),I=n(26),N=n(72),W=n(71),B=n(38),L=new Set([].concat(["a","e","i","o","u","y"],["\u0259","a","\u0101","\xe4","au\u0307","e","\u0113","i","\u012b","\u014d","\u022f","\u022fi","\xfc","u\u0307"])),C=n(1),V=function(){function e(){Object(v.a)(this,e)}return Object(C.a)(e,null,[{key:"getKey",value:function(t){return"".concat(e.prefix,"-").concat(t)}},{key:"set",value:function(t,n){localStorage.setItem(e.getKey(t),n)}},{key:"get",value:function(t){return localStorage.getItem(e.getKey(t))}}]),e}();V.prefix="sapere-aude";var P=function(e){return e.split(/\s/).map((function(e){return{word:e,clearWord:e.replace(/[.,/#!?$%^&*;:{}=\-_`~()]/g,"").toLowerCase(),ipaSyllables:[],timestamps:[]}}))},M=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,s,i,o,c,l,h,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],r=[],!(a=V.get(t))){e.next=11;break}return e.prev=4,e.abrupt("return",JSON.parse(a));case 8:e.prev=8,e.t0=e.catch(4),console.warn(e.t0);case 11:return s="".concat("https://dictionaryapi.com/api/v3/references/collegiate/json","/").concat(t,"?key=").concat("32d6793f-fdbd-4861-bbfb-9d7ea4ad8625"),e.prev=12,e.next=15,m.a.get(s);case 15:i=e.sent,e.next=21;break;case 18:return e.prev=18,e.t1=e.catch(12),e.abrupt("return",r);case 21:if(i&&i.data&&i.data.length){e.next=23;break}return e.abrupt("return",r);case 23:if(-1!==(o=i.data.findIndex((function(e){var t,n=e.hwi;return null===n||void 0===n||null===(t=n.prs)||void 0===t?void 0:t.length})))){e.next=26;break}return e.abrupt("return",r);case 26:if(c=i.data[o].hwi,l=c.hw,h=c.prs,n=l.split("*"),h&&h[0]&&(r=h[0].mw.replace(/[()]/g,"").split("-")),0!==r.length){e.next=34;break}if((p=l.replace("*",""))===t){e.next=33;break}return e.abrupt("return",M(p));case 33:r=Object(T.a)(n);case 34:return V.set(t,JSON.stringify(r)),e.abrupt("return",r);case 36:case"end":return e.stop()}}),e,null,[[4,8],[12,18]])})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(I.cloneDeep)(t),r=n.map((function(e){return e.clearWord})),a=Array.from(new Set(r).values()),e.next=5,Promise.all(a.map((function(e){return M(e)})));case 5:return s=e.sent,n.forEach((function(e){var t=a.indexOf(e.clearWord);e.ipaSyllables=Object(T.a)(s[t])})),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(e){if(!e)return"";var t=[];if(L.forEach((function(n){e.includes(n)&&t.push(n)})),1===t.length)return t[0];var n=t[0];return t.forEach((function(e){e.length>n.length&&(n=e)})),n},z=function(e){var t=[];return{isReadable:e.reduce((function(e,n){var r=!!n.ipaSyllables.length&&n.ipaSyllables.map((function(e){return!!U(e)})).reduce((function(e,t){return e&&t}),!0);return r||t.push(n.word),e&&r}),!0),nonReadable:t}},F=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var t=speechSynthesis.getVoices();t.length?e(t):speechSynthesis.addEventListener("voiceschanged",(function(){return e(speechSynthesis.getVoices())}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(e){return["en-US","en-GB"].includes(e.lang)},D=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:if(t=e.sent,!(n=t.find((function(e){return e.name.includes("Zira")})))){e.next=6;break}return e.abrupt("return",n);case 6:if(!(r=t.find((function(e){return A(e)&&e.name.toLocaleLowerCase().includes("female")})))){e.next=9;break}return e.abrupt("return",r);case 9:return e.abrupt("return",t[0]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(u.a.mark((function e(t,n,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var a=t.map((function(e){return e.word})).join(" "),s=new SpeechSynthesisUtterance(a),i=Object(I.cloneDeep)(t),o=[];s.voice=n,s.volume=0,s.rate=r,s.addEventListener("boundary",(function(e){var t=e,n=t.charIndex,r=t.charLength,a=t.elapsedTime;o.push({charIndex:n+r,elapsedTime:a})})),s.addEventListener("end",(function(){var t=o[0].elapsedTime;return o.forEach((function(e){e.elapsedTime-=t})),i.forEach((function(e,t){for(var n=e.ipaSyllables,r=e.timestamps,a=(o[t+1].elapsedTime-o[t].elapsedTime)/n.length,s=0;s<n.length;s+=1)r.push(o[t].elapsedTime+a*s)})),e(i)})),speechSynthesis.speak(s)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),K=function(e){var t=[];return e.forEach((function(e){var n=e.ipaSyllables,r=e.timestamps;n.forEach((function(e,n){t.push(Object(N.a)(r[n]).pipe(Object(B.a)((function(){return e}))))}))})),W.a.apply(void 0,t)},G=function(e){var t=e.onVowelSpoken,n=e.onSpeechEnded,s=Object(r.useState)(""),i=Object(o.a)(s,2),c=i[0],h=i[1],p=Object(r.useState)(!1),g=Object(o.a)(p,2),f=g[0],d=g[1],m=Object(r.useState)(!1),v=Object(o.a)(m,2),y=v[0],b=v[1],j=Object(r.useState)(!1),w=Object(o.a)(j,2),S=w[0],x=w[1],k=Object(r.useState)(""),O=Object(o.a)(k,2),T=O[0],I=O[1],N=Object(r.useState)(),W=Object(o.a)(N,2),B=W[0],L=W[1],C=function(e){return!!e.length&&e.length<=350};Object(r.useEffect)((function(){Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:t=e.sent,L(t);case 4:case"end":return e.stop()}}),e)})))()}),[]);var V=function(){var e=Object(l.a)(u.a.mark((function e(r){var a,s,i,o,l,h,p,g,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"===r.key&&C(c)){e.next=2;break}return e.abrupt("return");case 2:if(/^[A-Za-z0-9\s,.!?]*$/.test(c)){e.next=5;break}return I("In English, please!"),e.abrupt("return");case 5:return a=P(c),I("Requesting transcription..."),x(!0),e.next=10,R(a);case 10:if(a=e.sent,s=z(a),i=s.isReadable,o=s.nonReadable,i){e.next=16;break}return I('Cannot recognize word "'.concat(o[0],'"')),x(!1),e.abrupt("return");case 16:return I("Forming timeline..."),e.next=19,J(a,B,1);case 19:a=e.sent,(l=new SpeechSynthesisUtterance(c)).voice=B,l.rate=1,h=K(a),p=new H.a,g=function e(){p.add(h.subscribe((function(e){t(U(e))}))),l.removeEventListener("boundary",e)},l.addEventListener("boundary",g),f=function e(){p.unsubscribe(),l.removeEventListener("end",e),n(),I(""),x(!1)},l.addEventListener("end",f),I("Speaking..."),speechSynthesis.speak(l);case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",{className:"speech-container"},a.a.createElement("input",{className:E()("speech-text-input",{invalid:f&&!y}),disabled:S,placeholder:"Type something and hit Enter",onChange:function(e){var t=e.target.value;h(t),d(!0),b(C(t)),I("")},onKeyPress:V}),a.a.createElement("span",{className:"speech-status"},T),a.a.createElement("span",{className:E()("speech-symbols-counter",{invalid:f&&!y})},c.length," ","/",350))},q=(n(66),new Map([["\u0259",{jawHeight:.3,lipSync:.77}],["\u0113",{jawHeight:.13,lipSync:.28}],["a",{jawHeight:.49,lipSync:.41}],["\u0101",{jawHeight:.36,lipSync:.31}],["\xe4",{jawHeight:.35,lipSync:.73}],["au\u0307",{jawHeight:.47,lipSync:.72}],["e",{jawHeight:.25,lipSync:.38}],["i",{jawHeight:.21,lipSync:.46}],["y",{jawHeight:.21,lipSync:.46}],["\u012b",{jawHeight:.48,lipSync:.51}],["\u014d",{jawHeight:.25,lipSync:.85}],["\u022f",{jawHeight:.35,lipSync:.82}],["o",{jawHeight:.35,lipSync:.82}],["\u022fi",{jawHeight:.34,lipSync:.75}],["\xfc",{jawHeight:.16,lipSync:.8}],["u\u0307",{jawHeight:.22,lipSync:.87}],["u",{jawHeight:.22,lipSync:.87}]])),Z=function(){var e={jawHeight:0,lipSync:.5},t=Object(r.useState)(e),n=Object(o.a)(t,2),s=n[0],i=n[1],c=Object(r.useCallback)((function(e){var t=q.get(e);t?i(t):console.warn("Vowel not in map: ".concat(e))}),[]),u=Object(r.useCallback)((function(){i(e)}),[]);return a.a.createElement("div",{className:"app"},a.a.createElement(k,{morphControls:s}),a.a.createElement(G,{onVowelSpoken:c,onSpeechEnded:u}))};n(67),n(68);i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Z,null)),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.a1f61624.chunk.js.map